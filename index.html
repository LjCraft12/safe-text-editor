<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safe Text Editor</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <i class="fas fa-file-alt logo"></i>
                <div class="title-section">
                    <input type="text" id="docTitle" class="doc-title" value="Untitled Document" placeholder="Document Title">
                    <span class="subtitle">Safe Text Editor</span>
                </div>
                <button class="btn btn-reset" id="resetBtn" title="Reset All Data">
                    <i class="fas fa-undo-alt"></i>
                </button>
            </div>
            <div class="header-right">
                <!-- File Menu -->
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" id="fileMenuBtn">
                        <i class="fas fa-file"></i> File
                    </button>
                    <div class="dropdown-menu" id="fileMenu">
                        <button class="dropdown-item" id="newDocMenuBtn">
                            <i class="fas fa-plus"></i> New Document
                        </button>
                        <button class="dropdown-item" id="saveDocMenuBtn">
                            <i class="fas fa-save"></i> Save
                            <span class="shortcut">Ctrl+S</span>
                        </button>
                        <div class="dropdown-divider"></div>
                        <button class="dropdown-item" id="closeEditorBtn">
                            <i class="fas fa-times-circle"></i> Close Editor
                        </button>
                    </div>
                </div>
                <!-- Edit Menu -->
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" id="editMenuBtn">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <div class="dropdown-menu" id="editMenu">
                        <button class="dropdown-item" id="undoMenuBtn">
                            <i class="fas fa-undo"></i> Undo
                            <span class="shortcut">Ctrl+Z</span>
                        </button>
                        <button class="dropdown-item" id="redoMenuBtn">
                            <i class="fas fa-redo"></i> Redo
                            <span class="shortcut">Ctrl+Y</span>
                        </button>
                        <div class="dropdown-divider"></div>
                        <div class="dropdown-section-header">Document Flag</div>
                        <button class="dropdown-item flag-item" id="flagNoneBtn" data-flag="none">
                            <i class="fas fa-times-circle"></i> No Flag
                        </button>
                        <button class="dropdown-item flag-item" id="flagRedBtn" data-flag="red">
                            <span class="flag-color" style="background: #ef4444;"></span> Red - Urgent
                        </button>
                        <button class="dropdown-item flag-item" id="flagOrangeBtn" data-flag="orange">
                            <span class="flag-color" style="background: #f97316;"></span> Orange - Important
                        </button>
                        <button class="dropdown-item flag-item" id="flagYellowBtn" data-flag="yellow">
                            <span class="flag-color" style="background: #eab308;"></span> Yellow - Review
                        </button>
                        <button class="dropdown-item flag-item" id="flagGreenBtn" data-flag="green">
                            <span class="flag-color" style="background: #22c55e;"></span> Green - Complete
                        </button>
                        <button class="dropdown-item flag-item" id="flagBlueBtn" data-flag="blue">
                            <span class="flag-color" style="background: #3b82f6;"></span> Blue - In Progress
                        </button>
                        <button class="dropdown-item flag-item" id="flagPurpleBtn" data-flag="purple">
                            <span class="flag-color" style="background: #a855f7;"></span> Purple - Ideas
                        </button>
                    </div>
                </div>
                <!-- View Menu -->
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" id="viewBtn">
                        <i class="fas fa-eye"></i> View
                    </button>
                    <div class="dropdown-menu" id="viewMenu">
                        <button class="dropdown-item" id="showDocBarBtn">
                            <i class="fas fa-columns"></i> Show Document Bar
                        </button>
                        <button class="dropdown-item" id="themeBtn">
                            <i class="fas fa-palette"></i> Theme
                        </button>
                        <div class="dropdown-divider view-settings-divider"></div>
                        <button class="dropdown-item view-settings-btn" id="editViewSettingsBtn">
                            <i class="fas fa-cog"></i> Edit View Settings
                        </button>
                    </div>
                </div>
                <!-- Settings Menu -->
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" id="settingsBtn">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                    <div class="dropdown-menu" id="settingsMenu">
                        <div class="dropdown-section-header">File</div>
                        <button class="dropdown-item toggle-item" id="autoSaveToggleBtn">
                            <span class="item-content">
                                <i class="fas fa-save"></i> Auto Save
                            </span>
                            <span class="toggle-indicator" id="autoSaveIndicator"></span>
                        </button>
                        <div class="dropdown-divider settings-divider"></div>
                        <button class="dropdown-item settings-btn" id="advancedSettingsBtn">
                            <i class="fas fa-sliders-h"></i> Advanced Settings
                        </button>
                    </div>
                </div>
                <!-- Theme Mode Toggle (Light / Theme / Dark) -->
                <div class="theme-mode-toggle-wrapper">
                    <div class="theme-mode-toggle" id="themeModeToggle">
                        <span class="toggle-icon sun" data-mode="light" title="Light Mode"><i class="fas fa-sun"></i></span>
                        <span class="toggle-icon palette" data-mode="theme" title="Use Theme"><i class="fas fa-palette"></i></span>
                        <span class="toggle-icon moon" data-mode="dark" title="Dark Mode"><i class="fas fa-moon"></i></span>
                        <span class="toggle-slider-3way" id="toggleSlider"></span>
                    </div>
                </div>
                <button class="btn btn-secondary" id="newDocBtn">
                    <i class="fas fa-plus"></i> New
                </button>
                <button class="btn btn-primary" id="saveBtn">
                    <i class="fas fa-save"></i> Save
                </button>
                <div class="dropdown">
                    <button class="btn btn-secondary dropdown-toggle" id="exportBtn">
                        <i class="fas fa-download"></i> Export
                    </button>
                    <div class="dropdown-menu" id="exportMenu">
                        <button class="dropdown-item" id="exportHtml">Export as HTML</button>
                        <button class="dropdown-item" id="exportText">Export as Text</button>
                        <button class="dropdown-item" id="exportPdf">Print / Save as PDF</button>
                    </div>
                </div>
            </div>
        </header>

        <div class="main-content" id="mainContent">
            <!-- Editor Closed Message -->
            <div class="editor-closed-message" id="editorClosedMessage">
                <i class="fas fa-file-alt"></i>
                <h2>No Document Open</h2>
                <p>Create a new document or open an existing one to start editing.</p>
                <button class="btn btn-primary" id="openNewDocBtn">
                    <i class="fas fa-plus"></i> New Document
                </button>
            </div>

            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <button class="hamburger-btn" id="hamburgerBtn" title="Toggle Sidebar">
                        <span class="hamburger-line"></span>
                        <span class="hamburger-line"></span>
                        <span class="hamburger-line"></span>
                    </button>
                    <h3 id="sidebarTitle"><i class="fas fa-folder"></i> Documents</h3>
                    <button class="back-btn" id="folderBackBtn" style="display: none;">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                    <button class="add-btn" id="addBtn" title="Add New">
                        <i class="fas fa-plus"></i>
                    </button>
                </div>
                <div class="sidebar-content" id="sidebarContent">
                    <!-- Normal View -->
                    <div id="normalDocView">
                        <!-- Saved Documents Section -->
                        <div class="doc-section accordion-section" data-section="saved">
                            <div class="doc-section-header accordion-header" data-toggle="saved">
                                <span><i class="fas fa-chevron-down accordion-icon"></i><i class="fas fa-save"></i> Saved</span>
                                <span class="doc-count" id="savedDocCount">0</span>
                            </div>
                            <div class="accordion-content" id="savedAccordion">
                                <ul class="doc-list" id="docList">
                                    <li class="no-docs">No documents saved yet</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Folders Section -->
                        <div class="doc-section accordion-section" data-section="folders">
                            <div class="doc-section-header accordion-header" data-toggle="folders">
                                <span><i class="fas fa-chevron-down accordion-icon"></i><i class="fas fa-folder"></i> Folders</span>
                                <span class="doc-count" id="folderCount">0</span>
                            </div>
                            <div class="accordion-content" id="foldersAccordion">
                                <ul class="doc-list folder-list" id="folderList">
                                    <li class="no-docs">No folders created yet</li>
                                </ul>
                            </div>
                        </div>

                        <!-- Auto-Saved Documents Section -->
                        <div class="doc-section accordion-section" data-section="autosave">
                            <div class="doc-section-header accordion-header" data-toggle="autosave">
                                <span><i class="fas fa-chevron-down accordion-icon"></i><i class="fas fa-clock"></i> Auto-Saved</span>
                                <span class="doc-count" id="autoSaveDocCount">0</span>
                            </div>
                            <div class="accordion-content" id="autosaveAccordion">
                                <ul class="doc-list doc-list-autosave" id="autoSaveDocList">
                                    <li class="no-docs">No auto-saved documents</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- Folder View (shown when inside a folder) -->
                    <div id="folderDocView" style="display: none;">
                        <ul class="doc-list folder-contents" id="folderContentsList">
                            <li class="no-docs">This folder is empty</li>
                        </ul>
                    </div>
                </div>
                <!-- Resize Handle -->
                <div class="resize-handle" id="resizeHandle">
                    <div class="resize-handle-pill"></div>
                </div>
            </aside>

            <!-- Editor Area -->
            <main class="editor-container">
                <!-- Toolbar -->
                <div class="toolbar">
                    <!-- History -->
                    <div class="toolbar-group">
                        <button class="toolbar-btn" data-command="undo" title="Undo (Ctrl+Z)">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button class="toolbar-btn" data-command="redo" title="Redo (Ctrl+Y)">
                            <i class="fas fa-redo"></i>
                        </button>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Headings -->
                    <div class="toolbar-group">
                        <select class="toolbar-select" id="formatBlock" title="Paragraph Format">
                            <option value="p">Paragraph</option>
                            <option value="h1">Heading 1</option>
                            <option value="h2">Heading 2</option>
                            <option value="h3">Heading 3</option>
                            <option value="h4">Heading 4</option>
                            <option value="blockquote">Quote</option>
                            <option value="pre">Code Block</option>
                        </select>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Font -->
                    <div class="toolbar-group">
                        <select class="toolbar-select" id="fontName" title="Font Family">
                            <option value="Arial">Arial</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Times New Roman">Times New Roman</option>
                            <option value="Courier New">Courier New</option>
                            <option value="Verdana">Verdana</option>
                            <option value="Trebuchet MS">Trebuchet MS</option>
                        </select>
                        <select class="toolbar-select" id="fontSize" title="Font Size">
                            <option value="1">8pt</option>
                            <option value="2">10pt</option>
                            <option value="3" selected>12pt</option>
                            <option value="4">14pt</option>
                            <option value="5">18pt</option>
                            <option value="6">24pt</option>
                            <option value="7">36pt</option>
                        </select>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Text Formatting -->
                    <div class="toolbar-group">
                        <button class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                            <i class="fas fa-bold"></i>
                        </button>
                        <button class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                            <i class="fas fa-italic"></i>
                        </button>
                        <button class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                            <i class="fas fa-underline"></i>
                        </button>
                        <button class="toolbar-btn" data-command="strikeThrough" title="Strikethrough">
                            <i class="fas fa-strikethrough"></i>
                        </button>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Colors -->
                    <div class="toolbar-group">
                        <div class="color-picker-wrapper">
                            <button class="toolbar-btn" title="Text Color">
                                <i class="fas fa-font" style="border-bottom: 3px solid #000;"></i>
                            </button>
                            <input type="color" class="color-picker" id="foreColor" value="#000000">
                        </div>
                        <div class="color-picker-wrapper">
                            <button class="toolbar-btn" title="Highlight Color">
                                <i class="fas fa-highlighter"></i>
                            </button>
                            <input type="color" class="color-picker" id="backColor" value="#ffff00">
                        </div>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Alignment -->
                    <div class="toolbar-group">
                        <button class="toolbar-btn" data-command="justifyLeft" title="Align Left">
                            <i class="fas fa-align-left"></i>
                        </button>
                        <button class="toolbar-btn" data-command="justifyCenter" title="Align Center">
                            <i class="fas fa-align-center"></i>
                        </button>
                        <button class="toolbar-btn" data-command="justifyRight" title="Align Right">
                            <i class="fas fa-align-right"></i>
                        </button>
                        <button class="toolbar-btn" data-command="justifyFull" title="Justify">
                            <i class="fas fa-align-justify"></i>
                        </button>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Lists -->
                    <div class="toolbar-group">
                        <button class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                            <i class="fas fa-list-ul"></i>
                        </button>
                        <button class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                            <i class="fas fa-list-ol"></i>
                        </button>
                        <button class="toolbar-btn" data-command="indent" title="Increase Indent">
                            <i class="fas fa-indent"></i>
                        </button>
                        <button class="toolbar-btn" data-command="outdent" title="Decrease Indent">
                            <i class="fas fa-outdent"></i>
                        </button>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Insert -->
                    <div class="toolbar-group">
                        <button class="toolbar-btn" id="linkBtn" title="Insert Link">
                            <i class="fas fa-link"></i>
                        </button>
                        <button class="toolbar-btn" id="unlinkBtn" title="Remove Link">
                            <i class="fas fa-unlink"></i>
                        </button>
                        <button class="toolbar-btn" id="imageBtn" title="Insert Image">
                            <i class="fas fa-image"></i>
                        </button>
                        <button class="toolbar-btn" id="tableBtn" title="Insert Table">
                            <i class="fas fa-table"></i>
                        </button>
                        <button class="toolbar-btn" data-command="insertHorizontalRule" title="Horizontal Line">
                            <i class="fas fa-minus"></i>
                        </button>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Clear -->
                    <div class="toolbar-group">
                        <button class="toolbar-btn" data-command="removeFormat" title="Clear Formatting">
                            <i class="fas fa-eraser"></i>
                        </button>
                    </div>

                    <div class="toolbar-divider"></div>

                    <!-- Spell Check & Autocorrect -->
                    <div class="toolbar-group">
                        <div class="dropdown spellcheck-dropdown">
                            <button class="toolbar-btn" id="spellcheckBtn" title="Spelling & Autocorrect Options">
                                <i class="fas fa-spell-check"></i>
                            </button>
                            <div class="dropdown-menu spellcheck-menu" id="spellcheckMenu">
                                <div class="dropdown-header">
                                    <i class="fas fa-spell-check"></i> Spelling & Grammar
                                </div>
                                <div class="dropdown-option">
                                    <label class="toggle-option">
                                        <span>Spell Check</span>
                                        <input type="checkbox" id="spellcheckToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                <div class="dropdown-option">
                                    <label class="toggle-option">
                                        <span>Autocorrect</span>
                                        <input type="checkbox" id="autocorrectToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                <div class="dropdown-option">
                                    <label class="toggle-option">
                                        <span>Auto-capitalize</span>
                                        <input type="checkbox" id="autocapitalizeToggle" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                <div class="dropdown-divider"></div>
                                <div class="dropdown-header">
                                    <i class="fas fa-cog"></i> Options
                                </div>
                                <button class="dropdown-item" id="addWordBtn">
                                    <i class="fas fa-plus-circle"></i> Add Word to Dictionary
                                </button>
                                <button class="dropdown-item" id="manageWordsBtn">
                                    <i class="fas fa-book"></i> Manage Custom Dictionary
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Editor -->
                <div class="editor-wrapper">
                    <div class="editor" id="editor" contenteditable="true" spellcheck="true"></div>
                    <!-- Autocorrect suggestion popup -->
                    <div class="autocorrect-popup" id="autocorrectPopup">
                        <div class="autocorrect-suggestion" id="autocorrectSuggestion"></div>
                        <div class="autocorrect-actions">
                            <button class="autocorrect-accept" id="acceptCorrection" title="Accept (Tab)">
                                <i class="fas fa-check"></i>
                            </button>
                            <button class="autocorrect-dismiss" id="dismissCorrection" title="Dismiss (Esc)">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Status Bar -->
                <div class="status-bar">
                    <span id="wordCount">0 words</span>
                    <span id="flagStatus" class="flag-status"></span>
                    <span id="charCount">0 characters</span>
                </div>
            </main>
        </div>
    </div>

    <!-- Link Modal -->
    <div class="modal" id="linkModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Insert Link</h3>
                <button class="modal-close" data-modal="linkModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="linkUrl">URL</label>
                    <input type="url" id="linkUrl" placeholder="https://example.com">
                </div>
                <div class="form-group">
                    <label for="linkText">Link Text (optional)</label>
                    <input type="text" id="linkText" placeholder="Click here">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="linkModal">Cancel</button>
                <button class="btn btn-primary" id="insertLinkBtn">Insert Link</button>
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div class="modal" id="imageModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Insert Image</h3>
                <button class="modal-close" data-modal="imageModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="imageUrl">Image URL</label>
                    <input type="url" id="imageUrl" placeholder="https://example.com/image.jpg">
                </div>
                <div class="form-group">
                    <label for="imageAlt">Alt Text</label>
                    <input type="text" id="imageAlt" placeholder="Image description">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="imageModal">Cancel</button>
                <button class="btn btn-primary" id="insertImageBtn">Insert Image</button>
            </div>
        </div>
    </div>

    <!-- Table Modal -->
    <div class="modal" id="tableModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Insert Table</h3>
                <button class="modal-close" data-modal="tableModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label for="tableRows">Rows</label>
                        <input type="number" id="tableRows" value="3" min="1" max="20">
                    </div>
                    <div class="form-group">
                        <label for="tableCols">Columns</label>
                        <input type="number" id="tableCols" value="3" min="1" max="10">
                    </div>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="tableHeader" checked>
                        Include header row
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="tableModal">Cancel</button>
                <button class="btn btn-primary" id="insertTableBtn">Insert Table</button>
            </div>
        </div>
    </div>

    <!-- Add Word to Dictionary Modal -->
    <div class="modal" id="addWordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Add Word to Dictionary</h3>
                <button class="modal-close" data-modal="addWordModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="newWord">Word</label>
                    <input type="text" id="newWord" placeholder="Enter word to add">
                </div>
                <p class="form-hint">This word will no longer be marked as misspelled.</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="addWordModal">Cancel</button>
                <button class="btn btn-primary" id="saveWordBtn">Add Word</button>
            </div>
        </div>
    </div>

    <!-- Manage Dictionary Modal -->
    <div class="modal" id="dictionaryModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3><i class="fas fa-book"></i> Custom Dictionary</h3>
                <button class="modal-close" data-modal="dictionaryModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="dictionary-section">
                    <h4>Custom Words</h4>
                    <div class="dictionary-list" id="customWordsList">
                        <p class="empty-message">No custom words added yet.</p>
                    </div>
                </div>
                <div class="dictionary-section">
                    <h4>Autocorrect Rules</h4>
                    <div class="autocorrect-add-form">
                        <input type="text" id="autocorrectFrom" placeholder="Replace this...">
                        <span class="arrow-icon"><i class="fas fa-arrow-right"></i></span>
                        <input type="text" id="autocorrectTo" placeholder="With this...">
                        <button class="btn btn-primary btn-sm" id="addAutocorrectBtn">
                            <i class="fas fa-plus"></i>
                        </button>
                    </div>
                    <div class="dictionary-list" id="autocorrectRulesList">
                        <p class="empty-message">No custom autocorrect rules.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" data-modal="dictionaryModal">Close</button>
            </div>
        </div>
    </div>

    <!-- Theme Modal -->
    <div class="modal" id="themeModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3><i class="fas fa-palette"></i> Choose Theme</h3>
                <button class="modal-close" id="themeModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="theme-tabs">
                    <button class="theme-tab active" data-tab="basic">
                        <i class="fas fa-swatchbook"></i> Basic
                    </button>
                    <button class="theme-tab" data-tab="animated">
                        <i class="fas fa-magic"></i> Animated
                    </button>
                </div>
                <div class="theme-tab-content active" id="basicThemes">
                    <div class="theme-grid" id="themeGrid">
                        <!-- Basic themes will be populated by JavaScript -->
                    </div>
                </div>
                <div class="theme-tab-content" id="animatedThemes">
                    <div class="theme-grid" id="animatedThemeGrid">
                        <!-- Animated themes will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="themeCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="themeSaveBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Advanced Settings Modal -->
    <div class="modal" id="advancedSettingsModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3><i class="fas fa-sliders-h"></i> Advanced Settings</h3>
                <button class="modal-close" id="advancedSettingsModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <!-- FILE SETTINGS SECTION -->
                <div class="settings-group">
                    <div class="settings-group-header">
                        <i class="fas fa-file-alt"></i> File Settings
                    </div>

                    <div class="settings-section">
                        <h4><i class="fas fa-rocket"></i> Default Load Action</h4>
                        <p class="settings-description">What happens when the app starts.</p>

                        <div class="auto-save-config">
                            <div class="config-row">
                                <label for="defaultLoadAction">On startup</label>
                                <select id="defaultLoadAction" class="config-select config-select-wide">
                                    <option value="newDocument">Load New Document</option>
                                    <option value="lastSaved">Load Last Saved Document</option>
                                    <option value="lastAutosave">Load Last Autosave</option>
                                    <option value="showWarnings">Show Warnings</option>
                                    <option value="doNothing">Do Nothing</option>
                                </select>
                            </div>
                            <p class="config-hint">Choose what to display when the editor first loads.</p>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h4><i class="fas fa-save"></i> Auto Save Interval</h4>
                        <p class="settings-description">How often to automatically save your document.</p>

                        <div class="auto-save-config">
                            <div class="config-row">
                                <label for="autoSaveValue">Save every</label>
                                <div class="number-input-wrapper">
                                    <input type="number" id="autoSaveValue" class="config-input" min="1" max="999" value="5">
                                    <div class="number-input-controls">
                                        <button type="button" class="num-up" data-target="autoSaveValue"><i class="fas fa-chevron-up"></i></button>
                                        <button type="button" class="num-down" data-target="autoSaveValue"><i class="fas fa-chevron-down"></i></button>
                                    </div>
                                </div>
                                <select id="autoSaveUnit" class="config-select">
                                    <option value="minutes">Minutes</option>
                                    <option value="seconds">Seconds</option>
                                    <option value="words">Words typed</option>
                                    <option value="characters">Characters typed</option>
                                    <option value="changes">Changes made</option>
                                </select>
                            </div>
                            <p class="config-hint" id="autoSaveHint">Document will be saved every 5 minutes of editing.</p>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h4><i class="fas fa-archive"></i> Auto-Save Storage</h4>
                        <p class="settings-description">Maximum number of auto-saved documents to keep.</p>

                        <div class="auto-save-config">
                            <div class="config-row">
                                <label for="autoSaveLimit">Keep up to</label>
                                <div class="number-input-wrapper">
                                    <input type="number" id="autoSaveLimit" class="config-input" min="1" max="99" value="3">
                                    <div class="number-input-controls">
                                        <button type="button" class="num-up" data-target="autoSaveLimit"><i class="fas fa-chevron-up"></i></button>
                                        <button type="button" class="num-down" data-target="autoSaveLimit"><i class="fas fa-chevron-down"></i></button>
                                    </div>
                                </div>
                                <span class="config-label">auto-saved documents</span>
                            </div>
                            <p class="config-hint">Oldest auto-saves will be removed when limit is reached.</p>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h4><i class="fas fa-trash-alt"></i> Auto-Delete</h4>
                        <p class="settings-description">Automatically delete old auto-saved documents.</p>

                        <div class="auto-save-config">
                            <div class="config-row">
                                <label for="autoDeleteDays">Delete auto-saves after</label>
                                <div class="number-input-wrapper">
                                    <input type="number" id="autoDeleteDays" class="config-input" min="1" max="365" value="7">
                                    <div class="number-input-controls">
                                        <button type="button" class="num-up" data-target="autoDeleteDays"><i class="fas fa-chevron-up"></i></button>
                                        <button type="button" class="num-down" data-target="autoDeleteDays"><i class="fas fa-chevron-down"></i></button>
                                    </div>
                                </div>
                                <span class="config-label">days</span>
                            </div>
                            <p class="config-hint">You'll be warned 24 hours before deletion.</p>
                        </div>
                    </div>
                </div>

                <!-- DOCUMENT FLAGS SECTION -->
                <div class="settings-group">
                    <div class="settings-group-header">
                        <i class="fas fa-flag"></i> Document Flags
                    </div>

                    <div class="settings-section">
                        <h4><i class="fas fa-border-style"></i> Flag Border Appearance</h4>
                        <p class="settings-description">Configure how the flag border looks around the editor.</p>

                        <div class="auto-save-config">
                            <div class="config-row">
                                <label for="flagBorderWidth">Border width</label>
                                <div class="number-input-wrapper">
                                    <input type="number" id="flagBorderWidth" class="config-input" min="1" max="10" value="3">
                                    <div class="number-input-controls">
                                        <button type="button" class="num-up" data-target="flagBorderWidth"><i class="fas fa-chevron-up"></i></button>
                                        <button type="button" class="num-down" data-target="flagBorderWidth"><i class="fas fa-chevron-down"></i></button>
                                    </div>
                                </div>
                                <span class="config-label">pixels</span>
                            </div>
                            <p class="config-hint">Border thickness around the editor when a flag is set.</p>
                        </div>
                    </div>
                </div>

                <!-- NOTIFICATIONS SECTION -->
                <div class="settings-group">
                    <div class="settings-group-header">
                        <i class="fas fa-bell"></i> Notifications
                    </div>

                    <div class="settings-section">
                        <h4><i class="fas fa-comment-dots"></i> Toast Notifications</h4>
                        <p class="settings-description">Configure popup notification preferences.</p>

                        <button class="btn btn-secondary settings-sub-btn" id="toastSettingsBtn">
                            <i class="fas fa-sliders-h"></i> Toast Settings
                        </button>
                    </div>
                </div>

                <!-- MODAL BEHAVIOR SECTION -->
                <div class="settings-group">
                    <div class="settings-group-header">
                        <i class="fas fa-window-restore"></i> Modal Behavior
                    </div>

                    <div class="settings-section">
                        <h4><i class="fas fa-mouse-pointer"></i> Click Outside Action</h4>
                        <p class="settings-description">What happens when you click outside a modal dialog.</p>

                        <div class="auto-save-config">
                            <div class="config-row">
                                <label for="modalClickOutside">Action</label>
                                <select id="modalClickOutside" class="config-select config-select-wide">
                                    <option value="nothing">Do Nothing</option>
                                    <option value="cancel">Close &amp; Cancel</option>
                                    <option value="save">Close &amp; Save</option>
                                </select>
                            </div>
                            <p class="config-hint">Applies to all modals with save/cancel options.</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="advancedSettingsCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="advancedSettingsSaveBtn">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Toast Settings Modal -->
    <div class="modal" id="toastSettingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-bell"></i> Toast Settings</h3>
                <button class="modal-close" id="toastSettingsModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <div class="master-toggle">
                        <div class="master-toggle-info">
                            <h4><i class="fas fa-bell"></i> Enable Toast Notifications</h4>
                            <p>Show popup notifications for actions</p>
                        </div>
                        <label class="toggle-option">
                            <input type="checkbox" id="toastMasterToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-divider-line"></div>

                <div class="settings-section" id="toastIndividualSettings">
                    <h4>Individual Toast Settings</h4>
                    <p class="settings-description">Enable or disable specific notifications.</p>

                    <div class="toast-options-list">
                        <div class="toast-option-item">
                            <div class="toast-option-info">
                                <span class="toast-option-label">Auto-save notifications</span>
                                <span class="toast-option-desc">When document is auto-saved</span>
                            </div>
                            <label class="toggle-option">
                                <input type="checkbox" id="toastAutoSave" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="toast-option-item">
                            <div class="toast-option-info">
                                <span class="toast-option-label">Document saved</span>
                                <span class="toast-option-desc">When document is manually saved</span>
                            </div>
                            <label class="toggle-option">
                                <input type="checkbox" id="toastDocSave" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="toast-option-item">
                            <div class="toast-option-info">
                                <span class="toast-option-label">Document deleted</span>
                                <span class="toast-option-desc">When document is deleted</span>
                            </div>
                            <label class="toggle-option">
                                <input type="checkbox" id="toastDocDelete" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="toast-option-item">
                            <div class="toast-option-info">
                                <span class="toast-option-label">Theme changes</span>
                                <span class="toast-option-desc">When theme is saved</span>
                            </div>
                            <label class="toggle-option">
                                <input type="checkbox" id="toastTheme" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="toast-option-item">
                            <div class="toast-option-info">
                                <span class="toast-option-label">Settings changes</span>
                                <span class="toast-option-desc">When settings are updated</span>
                            </div>
                            <label class="toggle-option">
                                <input type="checkbox" id="toastSettings" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="toast-option-item">
                            <div class="toast-option-info">
                                <span class="toast-option-label">Spellcheck & Autocorrect</span>
                                <span class="toast-option-desc">Toggle and dictionary notifications</span>
                            </div>
                            <label class="toggle-option">
                                <input type="checkbox" id="toastSpellcheck" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>

                        <div class="toast-option-item">
                            <div class="toast-option-info">
                                <span class="toast-option-label">Document bar visibility</span>
                                <span class="toast-option-desc">When document bar is hidden/shown</span>
                            </div>
                            <label class="toggle-option">
                                <input type="checkbox" id="toastDocBar" checked>
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="toastSettingsCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="toastSettingsSaveBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Auto-Save Deletion Warning Modal -->
    <div class="modal" id="autoSaveWarningModal">
        <div class="modal-content modal-lg">
            <div class="modal-header modal-header-warning">
                <h3><i class="fas fa-exclamation-triangle"></i> Auto-Saves Expiring Soon</h3>
                <button class="modal-close" id="autoSaveWarningClose">&times;</button>
            </div>
            <div class="modal-body">
                <p class="warning-description">The following auto-saved documents will be automatically deleted within 24 hours:</p>
                <ul class="expiring-docs-list" id="expiringDocsList">
                    <!-- Populated by JavaScript -->
                </ul>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="autoSaveWarningCloseBtn">Close</button>
            </div>
        </div>
    </div>

    <!-- Reset Confirmation Modal -->
    <div class="modal" id="resetModal">
        <div class="modal-content">
            <div class="modal-header modal-header-warning">
                <h3><i class="fas fa-exclamation-triangle"></i> Reset All Data?</h3>
                <button class="modal-close" id="resetModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <p class="reset-warning-text">This will permanently delete:</p>
                <ul class="reset-list">
                    <li><i class="fas fa-file-alt"></i> All saved documents</li>
                    <li><i class="fas fa-palette"></i> Theme preferences</li>
                    <li><i class="fas fa-columns"></i> Sidebar settings</li>
                    <li><i class="fas fa-book"></i> Custom dictionary words</li>
                    <li><i class="fas fa-spell-check"></i> Autocorrect rules</li>
                    <li><i class="fas fa-cog"></i> All other settings</li>
                </ul>
                <p class="reset-note">The page will refresh and everything will be restored to default.</p>
                <p class="reset-caution"><i class="fas fa-exclamation-circle"></i> This action cannot be undone!</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="resetCancelBtn">Cancel</button>
                <button class="btn btn-danger" id="resetConfirmBtn">
                    <i class="fas fa-undo-alt"></i> Reset Everything
                </button>
            </div>
        </div>
    </div>

    <!-- Bubble Context Menu -->
    <div class="bubble-context-menu" id="bubbleContextMenu">
        <button class="context-menu-item" id="hideBubbleBtn">
            <i class="fas fa-eye-slash"></i> Hide Document Bar
        </button>
    </div>

    <!-- Hamburger Context Menu -->
    <div class="bubble-context-menu" id="hamburgerContextMenu">
        <button class="context-menu-item" id="hideHamburgerBtn">
            <i class="fas fa-eye-slash"></i> Hide Document Bar
        </button>
    </div>

    <!-- Add Button Context Menu -->
    <div class="bubble-context-menu" id="addContextMenu">
        <button class="context-menu-item" id="newFolderBtn">
            <i class="fas fa-folder-plus"></i> New Folder
        </button>
    </div>

    <!-- Folder Context Menu -->
    <div class="bubble-context-menu" id="folderContextMenu">
        <button class="context-menu-item" id="openFolderBtn">
            <i class="fas fa-folder-open"></i> Open Folder
        </button>
        <button class="context-menu-item" id="renameFolderBtn">
            <i class="fas fa-edit"></i> Rename Folder
        </button>
        <div class="context-menu-divider"></div>
        <button class="context-menu-item context-menu-danger" id="deleteFolderBtn">
            <i class="fas fa-trash"></i> Delete Folder
        </button>
    </div>

    <!-- Document Context Menu -->
    <div class="bubble-context-menu" id="docContextMenu">
        <button class="context-menu-item has-submenu" id="moveToFolderBtn">
            <i class="fas fa-folder-open"></i> Move To...
            <i class="fas fa-chevron-right context-submenu-arrow"></i>
        </button>
        <button class="context-menu-item" id="copyDocBtn">
            <i class="fas fa-copy"></i> Copy
        </button>
        <div class="context-menu-divider"></div>
        <button class="context-menu-item context-menu-danger" id="deleteDocContextBtn">
            <i class="fas fa-trash"></i> Delete
        </button>
    </div>

    <!-- Move To Folder Submenu -->
    <div class="bubble-context-menu submenu" id="moveToSubmenu">
        <button class="context-menu-item" id="moveToRootBtn">
            <i class="fas fa-home"></i> Root (No Folder)
        </button>
        <div class="context-menu-divider" id="moveToSubmenuDivider"></div>
        <div id="moveToFolderList">
            <!-- Populated by JavaScript -->
        </div>
        <div class="no-folders-msg" id="noFoldersMsg" style="display: none;">
            No folders created yet
        </div>
    </div>

    <!-- Delete Document Confirmation Modal -->
    <div class="modal" id="deleteDocModal">
        <div class="modal-content">
            <div class="modal-header modal-header-warning">
                <h3><i class="fas fa-exclamation-triangle"></i> Delete Document?</h3>
                <button class="modal-close" id="deleteDocModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <p>Are you sure you want to delete "<strong id="deleteDocTitle"></strong>"?</p>
                <p class="reset-caution"><i class="fas fa-exclamation-circle"></i> This action cannot be undone!</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="deleteDocCancelBtn">Cancel</button>
                <button class="btn btn-danger" id="deleteDocConfirmBtn">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        </div>
    </div>

    <!-- Create Folder Modal -->
    <div class="modal" id="createFolderModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-folder-plus"></i> Create New Folder</h3>
                <button class="modal-close" id="createFolderModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="folderNameInput">Folder Name</label>
                    <input type="text" id="folderNameInput" placeholder="Enter folder name..." maxlength="50">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="createFolderCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="createFolderConfirmBtn">Create Folder</button>
            </div>
        </div>
    </div>

    <!-- Rename Folder Modal -->
    <div class="modal" id="renameFolderModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Rename Folder</h3>
                <button class="modal-close" id="renameFolderModalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="renameFolderInput">Folder Name</label>
                    <input type="text" id="renameFolderInput" placeholder="Enter new folder name..." maxlength="50">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" id="renameFolderCancelBtn">Cancel</button>
                <button class="btn btn-primary" id="renameFolderConfirmBtn">Rename</button>
            </div>
        </div>
    </div>

    <!-- Theme Tooltip -->
    <div class="theme-tooltip" id="themeTooltip">
        <div class="theme-tooltip-title">
            <i class="fas fa-palette"></i>
            <span id="tooltipThemeName">Theme Name</span>
        </div>
        <div class="theme-tooltip-colors" id="tooltipColors">
            <!-- Color swatches populated by JS -->
        </div>
        <div class="theme-tooltip-description" id="tooltipDescription">
            Theme description here.
        </div>
        <div class="theme-tooltip-animation" id="tooltipAnimation" style="display: none;">
            <i class="fas fa-magic"></i>
            <span id="tooltipAnimationText">Animation details</span>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
